# tasks/configure_apache.yml
---
- name: Enable Apache modules
  loop:
    - rewrite
    - ssl
  community.general.apache2_module:
    name: "{{ item }}"
    state: present

- name: Configure Apache virtual host for webtrees
  ansible.builtin.template:
    src: webtrees.conf.j2
    dest: /etc/apache2/sites-available/webtrees.conf

- name: Enable webtrees virtual host
  ansible.builtin.file:
    src: /etc/apache2/sites-available/webtrees.conf
    dest: /etc/apache2/sites-enabled/webtrees.conf
    state: link

# Restart Apache

- name: Restart Apache
  ansible.builtin.service:
    name: apache2
    state: restarted
